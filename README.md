# 象棋小游戏

这是一个象棋小游戏的简单实现，其中包括若干部分：

## 棋盘逻辑处理器

这是一个用于处理棋盘逻辑的类，包括了棋盘的初始化、棋子的移动、棋子的吃子、棋子的悔棋、棋子的撤销悔棋、棋子的判断等功能。

下面是对「棋盘逻辑处理器」的所有状态描述说明：

以及，强调一下，与棋盘进行交互的人，统称为「参与者」。

### 参与者

参与者一共分为三种：匿名、观众、玩家（唯二）。

匿名者可以查询：游戏当前进行的状态 【等待开始 / 进行游戏 / 复盘模式】

同时，匿名者也可以以「观众」身份加入游戏 ( 预期会得到「接受」和「拒绝」两种情形 )

当被接受时，匿名者会同时得到一个长度为 256 位的标识符，并同时会向服务端发送其妮称。

若当前战局没有玩家，则观众可以自选一方加入游戏成为该方玩家。（ 同样会得到「接受」和「拒绝」两种情形。 ）

特别的，服务器可以主动发送信息提醒「参与者」被移出玩家队列成为观众；踢出房间。

关于消息发送，目前只支持「广播」操作。



### 空闲状态 

在处理器启动之初：该处理器处于空闲状态，此时棋盘上没有棋子。(state: free) 




下面是对它的自动机描述： 

在处理器启动之初：该处理器处于空闲状态，此时棋盘上没有棋子。(state: free) 
任何指令都有一个对单方面唯一的 transaction id, 以便接收回复。
通过指令 apply as player (red / black) | audience 来设置自己为相应的角色，并在棋盘管理器同意后得到一个唯一的 id (类型 unsigned 128). 
之后所有的指令都必须带上身份 ID . 
身份检验机制：发起重新检验指令 reconnect (id) 
如果身份合法，则服务器会尝试连接原 id 对应的客户端，如果无法成功连接，则接受新连接作为新的客户端，继承之前所有游戏信息。 
该检验消息为 check, 是一句空内容消息，需要回复一个空内容消息。
reconnect 只有在成功时得到回复，即它的新 ID . 

游戏妮称设置指令： set nickname (id, nickname) 

